#http 웹 기본 지식
## 색션1: 인터넷 네트워크
##### 인터넷통신
- 
##### IP
- 
##### TEC, UDP
- 인터넷 프로토콜 스택의 4계층
1. 애플리케이션 계층 - http, Ftp
2. 전송계층 - tcp, udp
3. 인터넷 계층- ip
4. 네트웨크(렌등등) 인터페이스 계층

- ex) 
1.프로그램이 헬로우 월드 메세지 생성
2. 소켓 라이브러리를 통해 전달
3. tcp정보가 해당 메세지 데이터롤 포함에서 감싼다
4. tcp 까지 감싸져 잇는걸 ip로 한번더 감싼 패킷으로 만들어서(ip+ tcp) 
5. 네트웨크를 통해 다른 서버로 보냄

- TEC:http/1

- UDP: http/3
##### PORT
- 같은 ip 내에서 프로세스 구분
- 패킷 보낼때 출발지, 목적지 ip + port 같이 보냄
- 한 아파트(서버)라면 호수가 포트 라고 비유

##### DNS
- ip는 기억하기 어렵다 => 길자나~ 그리고 변경 될수 잇다 그래서 도메인 네임 시스템사용
- 도메인명을 ip 주소로 변한 

## 색션2: URI와 웹 브라우저 요청 흐름
##### URI
- URI는 로케이터(locator), 이름(name) 또는 둘다 추가로 분료 될수 잇음
- 프로토콜: 어떤 자원에
##### 웹 브라우저 요청 흐름

### 색션3: 모든것이 http
##### 모든것이 http
- http 메세지에 모든것을 전송
- 현재 http/1.1 주로 사용

##### http 특징
클라이언트 서버구조
무상태 프로토콜 비연결성
http 메시지
단순한 확장가능

이벤트 페이지등

stateful: 상태유지
서버가 클라이언트 이전 상태를 보존
중간에 점원이 바뀌면 서버에러
로그인 상태를 서버에 유지 할 경우


비연결성
서버는 연결 유지x -> 현재 요청을 주고 받을때만 연결 요청할때만 연결 ->  최소한의 자원으로 서버 유지
단점은 tcp/ip 연결을새로 연결 맺어야함 -> 시간 추가
 http 지속 연결 :
 다 받을때까지 연결

스테리스리스를 기억하자

http 메세지
- http 메시지에 모든걸 보낼수 잇다
- 요청과 응답 구조가 다름
http 메시지 구조

시작 라인
요청 : http메서드(서버가 수행해야할 동작지정) + 요청대상(절대경로) + http 버전
응답 : http 버전 + http 상태(요청 성공, 실패를 나타냄

해더(http 전송에 필요한 부가 정보)
필드네임: 벨류

공배라인

메세지바디
실제 전송할 데이터

http api를 만들어보자
리소스와 행위를 분리
url는 리소스만 식별
리소스는: 명사 행위는 동사


get
리소스 조회
서버에 전달하고 싶은 데이터는 쿼리 파라미터 쿼리스트링를 통해 전달

post
메시지 바디를 통해 서버로 요청 데이터 전달
회원가입, 주문,
게시판 글쓰기 댓글다기
다른메서드로 처리하기 애매하기 경우
get 메서드 사용하기 애매하기 -> post 사용


put
리소스를 대체
쉡게 이야기하면 덮어버림 -> 수정
클라이언트가 리소스를 식별**** 중요 post와 차이

patch
리소스 부분 변경


http 메서드 속성
안전: 호출해두 리소스를 변경하지 않느다
멱등: 같은 요청을 한번 호출하든 100번 호출하든 결과가 똑같다
자동 메커니즘,  요청후 실패하면 자동으로 요청 
캐시가능: 응답 결과를 리소스를 캐시해서 사용해도 되는가
get head 정도만 캐시 가능


정적 데이터 조회
get으로해서 리소스 경로만
이미지 정적 테스트 문서 조회시

동적 데이터 조회
쿼리 파라미터사용
주소에 쿼리 넣어서  서버로 보냄
주로 검색 게시판 목록 정렬필터 사용
조호 조건 줄여주는 핉터 많이 사용
조회는 get 사용

html form 데이터 전송 일때
1. post 전송 - 저장
- 메세지바디에 넣어서 보넴 키 밸류 형식으로
2. get 전송-  url 경로로 쿼리를 넣어서
3. multipart/form-data 일경우 =>
- 웹브라우저가 자동으로 http 메세지에 여러개 멀티로 해당 타입의 보내준다
주로 파일 업로드 같은 바이너리 데이터 전송시 사용

http api데이터 전송
서버 to 서버
앱 클라이언트
웹클라언트(리액트 같은 웹클라이언트 apㅑ통신)
** 주로 이거 우리가 사용 하는 방식 같음
html form 전송 대신 자바스크립트를 통한 통신에 사용(ajax)


[ http api 설계 예시 ]
1. http api - 컬렉션
- post 기반 등록
- 회원 새로 등록 같은
2.http api -스토어
-put



ex)
리소스 식별
 api 설계 -post 기반 ㄷㅇ록
목록 get
등록 post
조회 get /members/{id}
수정 patch(부분적), put(덮어쓰기: 게시글 수정 ), post /members/{id}
삭제 delete /members/{id}

post: 신규 자원등록 특징
클라이언트는 등록될 리소스 url를 모른다.
서버가 새로 등록된 리소스 url 생성해준다
이런 형식을 컬렉션이라고 함


put
파일 등록 files/{fileName} =>put
파일이 잇으면 덮어쓰고 아니면 새로 생성
클라이언트가 리소스 url를 알고 잇어야한다
클라이언트가 직접 리소스의 url를 지정한다
이런 형식을 스토어라고 한다

html form 사용
- html form get, post만 지원
- http 메서드로 해경하기 애매한 경우 http apㅑ 사용
- 동사로 리소스 사용

참고 하기 좋은 url 설계 개념
문서:
단일 개념(파일하나, 객체 인스턴스, 데이터 베이스 row)

컬렉션:
서버가 관리하는 리소스 디렉토리

스토어:
클라이언트가 관리하는 자원 자원소
/files

컨트롤러 컨트로 url:
문서, 컬렉션, 스토어로 해겨하기 어려운 추가 프로세스 실행
동사를 직접사영
member/i{d}/delete


http 상태코드
클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주느 ㄴㅅ기능
1xx 요청이 수신되어 ㅓ리중
2xx 요청정상처리
3xx 요청으 완료하려면 추가 해동이 필요
4xx  클라이언트 오류, 잘못된 문법등으로 서버가 요청 수행 x
5xx 서버오루. 서버가 정상 요청을 처리하지 못함

만야 모르는 상태 코드가 나타나면
백단위로 확인해서, 상태코드로 확인

디데일 설명
1xx
거의 사용 않함

2xx - 성공
200 ok
클러ㅏ이언트 요청 보냄 => 서버가 200 ok 응답으로

201 created post로 등록 됫을때 
요청 성공해서 새로운 리소스가 생성된
생성된 리소스는 응답의 로케이션 해더 필드로 식별


202 Accepted
요청이 접소 됫으나 처리가 완료 되지 않음

204 서버가 요청을 성공적으로 수햇지만 응답 페이로드 본문에 보낼 데이터가 ㅇㅄ음
not content
save  버튼의 결과로 아무 내용이 없을때 
결과 내용이 없어두 204 메시지 만ㅇ으로 성공을 인식 할수 잇음

3xx- 리다이액션
요청을 완료하기 위해 유저에이전트의(웹브라이저) 작업이 필요함
리다이렉션: 웹부라우저는 
3xx응답의 결과에 로케이션 해더가 
잇으면 자동으록ㅇ이동함

리다이렉션 이해
종류
영구 리다이레션 :  특정 리소스의 url가 영구적으로 이동
301,308 원래의 url를 사용 x
301: 리다이렉트 요청시 메서드가 get으로 변함
메서지 바디, 메서지 가 제거됨
=> 그럼 사용자 입장에서 다시 입력해야함
308: post 유지 메세지 유지


일시 리다이렉션- 일시적인 벼경
302,307,303
302: 리다이렉트 요청시 메서드가 get으로 변함(아마)
307: 302 기능 같음 
리다이렉트시 요처메서드와 본문 유지
(요청 메시드를 변경하면 안된다 must not)
303
get으로 변경 반드시!
주문 완료후ㅜ 주문내역확면으로 이동
prg
post로 주문후 주문 결과 하면을 get 메서드로 리다이렉트
새로고침해도 결과 화면을 get으로 조회
이런식으로 일시적인 리다리렉트 많이 사용
=> 중복주문 문제 해결


특수 리다이렉션
300 304
304 캐시를 목적으로 사용
캐시로 리다이렉트 한다
클라이언트에게 리소스가 수정되지 않음을 알려줌
그래서 다운 안하고 캐시로 써라 를 알려줌

4xx
클라언트 오류
400 : 요총 파라미터가 잘못되거나 api  스펙이 맞지 않을때
401: 클라이언트가 해당 리소스에 대한 인증이 필요함
인증 되지 않음
인증:본인이 누구인지 확인(로그인)
인가: 권한부여(어드민 권한 처런 특정 리소스에 접급할수 잇는 권한)
403: 서버가 요청 이해햇지만 승인 거부함
어드민 등급이 아닌 로그인 사용자가 접근
404 요청 리소스가 서버에 없음

5xx  서버 문제로 오류 발생
애매하면 500 오류
503: t서비스 이용 불가

http 헤더
 - 필드 네임: 필드 벨류모양으로 쓰임
- http 전송에 필요한 모든 부가정보를 넣음
- 메시지 바디의 내용, 바디의 크기 등등 무수한 내용등


http 바디
과거엔 엔티티 라고 잇엇으나 지금은 표현으로 바뀜
메시지 본문을 통해 표현 데이터 전달
메시지 본문 =  페이로드
표현은 요청이나 응당에서 전달할 실제 데이터 
표혀 헤더는 표현데이터를 해석할수 잇는 정보 제공
   - 데이터 유형, 데이터 길이, 압축 정보 등등

표현 해더란
표현 데이터의 형식, 압축방식, 자연언어, 데이터 길이
표혀 헤더는 전송, 응답 둘다 사용

content -type
표현 데이터의 형식 설명
바디에 들어갈 형식이 머야? 그걸 적어줌

contet-encoding
표현데이터를 압축하기 위해 사용

content-language
표현 데이터의 자연 언어를 표현

content-length
바이트 단위
전송코딩을 사용하면 content-length 사용 하면 안됨

협상(콘텐츠 네고시에이션): 클라이언트가 선호하는 표현 요청
협상헤더는 요청시에만 사용
accept :  클라이언트가 선호하는ㄴ 미디어 타입 전달
accept -charset: 클라이언트가 선호하는 문자 인코딩
accept -encoding: 클라이언트가 선호하는 압축 인코딩
accept -language: 클라이언트가 선호하는 자연언어


협상과 우선순위1
quality values(q)
0~1 클루소록 높ㅇㄴ 우선순위
생략하면 1
accept -language:Ko-KR;q=0.9;en-US;q=0.7;
로 하면 한국어가 우선순위, 그다음 영어

협상과 우선순위2
구체적인것이 우선한다
accept: text/*, text/plain

전송방식

단순전송
한번에 요청하고 한번에 쭉 받는것

압축전송
서버에서 압축함 -> cotent-encoding,을 꼭 넣어줘야함 그래야 클라이언트에서 알수 잇음 멀로 압축햇는데

분할 전성
transfer-encoding: chunked
chunked란 덩어리라는 것
서버에서 쪼개서 보내줨

범위 전송
예를 들어 이미지를 받는데 이미지의 바이트를 중간 크기까지 이미 받앗다면 다시 처음부터 받지 않아두 된다
범위전송으로 받을 범위를 지정해서 보내줌


일반 정보
from: 유저 에이전트의 이메일 정보

referer: 이전 웹페이지 주소
a -> b로 이동하는 경우 b를 요총헐때 a를 포함해서 요청
유입경로 분석가능
요청에서 사용

user-agent
유저 에이전트 애플리케이션 정보(웹브라우저 정보)
웹브라우저 정보, 등등






